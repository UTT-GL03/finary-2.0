- name: Test Finary Dashboard Features
  url: http://localhost/
  # Wait for dashboard full load:
  # .grid is present only when loading = false
  waitForSelector: main.container .grid

  actions:
    - name: Go to incomes page
      type: click
      # The "View all" link for incomes
      element: "article:nth-of-type(2) header a[href='/incomes']"
      pageChange: true
      # Wait for incomes page: custom test-id
      waitForSelector: "[data-testid='incomes-loaded']"

    - name: Open first income detail
      type: click
      # First row, last td contains the <a> "View"
      element: "table tbody tr:nth-child(1) td:last-child a"
      pageChange: true
      # Wait for detail page: <h1>Détail de la dépense:</h1>
      waitForSelector: "main.container h1"

    - name: Return to dashboard
      type: click
      # Click the header logo (Link to="/")
      element: "header h1"
      pageChange: true
      # Wait again for dashboard fully loaded
      waitForSelector: "main.container .grid"

    - name: Go to outcomes page
      type: click
      # The "View all" link for outcomes
      element: "article:nth-of-type(3) header a[href='/outcomes']"
      pageChange: true
      # Wait for outcomes page to load
      waitForSelector: "[data-testid='outcomes-loaded']"

    - name: Open add expense dialog
      type: click
      # Click the "+ Add" button to open the dialog
      element: "[data-testid='add-money-button']"
      # Wait for the dialog to open
      waitForSelector: "[data-testid='add-money-dialog'][open]"

    - name: Fill expense amount
      type: fill
      # Fill in the amount field
      element: "[data-testid='amount-input']"
      content: "50"

    - name: Fill expense category
      type: fill
      # Fill in the category field
      element: "[data-testid='category-input']"
      content: "Test Expense"

    - name: Fill expense date
      type: fill
      # Fill in the date field
      element: "[data-testid='date-input']"
      content: "2025-12-15"

    - name: Submit expense
      type: click
      # Click the confirm button to submit
      element: "[data-testid='confirm-button']"
      # Wait for dialog to close (outcomes page should still be visible)
      waitForSelector: "[data-testid='outcomes-loaded']"

    - name: Scroll to savings dashboard
      type: scroll
      # Scroll to the PotentialEconomy component
      element: "[data-testid='potential-economy']"